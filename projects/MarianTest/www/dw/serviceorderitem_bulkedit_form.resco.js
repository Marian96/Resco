var dwserviceorderitem_bulkedit_form;dwserviceorderitem_bulkedit_form=function(){"use strict";var __webpack_modules__={7042:function(__unused_webpack_module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.LocalMaterialType=exports.LocalmaterialEntityNames=void 0;var LocalmaterialEntityNames=function LocalmaterialEntityNames(){this.entityLogicalName="dw_localmaterial",this.createdon="createdon",this.activitytypeid="dw_activitytypeid",this.alternativequantity="dw_alternativequantity",this.alternativeunitid="dw_alternativeunitid",this.calibrationinterval="dw_calibrationinterval",this.charge="dw_charge",this.companycode="dw_companycode",this.configurablematerial="dw_configurablematerial",this.consumablepart="dw_consumablepart",this.deliveryunit="dw_deliveryunit",this.erpcreated="dw_erpcreated",this.exporthandling="dw_exporthandling",this.languageid="dw_languageid",this.localmaterialid="dw_localmaterialid",this.materialnoid="dw_materialnoid",this.materialnumber="dw_materialnumber",this.name="dw_name",this.parttobereturned="dw_parttobereturned",this.parttobereturnedconditions="dw_parttobereturnedconditions",this.pricegroup="dw_pricegroup",this.protectionclass="dw_protectionclass",this.repairallowed="dw_repairallowed",this.salesorganisation="dw_salesorganisation",this.serviceproduct="dw_serviceproduct",this.servicetool="dw_servicetool",this.traceablepart="dw_traceablepart",this.type="dw_type",this.typeofuserpart="dw_typeofuserpart",this.udirelevant="dw_udirelevant",this.unitdescription="dw_unitdescription",this.unitid="dw_unitid",this.modifiedon="modifiedon",this.ownerid="ownerid"};exports.LocalmaterialEntityNames=LocalmaterialEntityNames,function(LocalMaterialType){LocalMaterialType[LocalMaterialType.ActivityType=1e8]="ActivityType",LocalMaterialType[LocalMaterialType.Material=100000001]="Material"}(exports.LocalMaterialType||(exports.LocalMaterialType={}))},2100:function(__unused_webpack_module,exports,__webpack_require__){Object.defineProperty(exports,"__esModule",{value:!0}),exports.ServiceorderitemBulkedit=void 0;var localmaterial_entity_names_1=__webpack_require__(7042),serviceorderitem_entity_names_1=__webpack_require__(8885),ServiceorderitemBulkedit=function(){function ServiceorderitemBulkedit(){}return ServiceorderitemBulkedit.prototype.initialize=function(){var _this=this;this.changedItems=[];var field=new serviceorderitem_entity_names_1.ServiceorderitemEntityNames,hideForTime=[field.executiondate,field.materialdescription,field.accountingindicator],hideForMaterial=[field.starttime,field.endtime,field.workcenter];MobileCRM.UI.EntityForm.requestObject((function(entityForm){var opt=entityForm.iFrameOptions;opt&&opt.type&&("time"===opt.type?_this.hideFields(entityForm,hideForTime):"material"===opt.type&&_this.hideFields(entityForm,hideForMaterial))}),(function(error){error&&MobileCRM.bridge.alert(error)})),MobileCRM.UI.EntityForm.onChange((function(entityForm){var changedItem=entityForm.context.changedItem;-1===_this.changedItems.indexOf(changedItem)&&_this.changedItems.push(changedItem)}),!0,null),MobileCRM.UI.EntityForm.onSave((function(entityForm){entityForm.suspendSave().resumeSave("Cannot save bulk edit record, use buttons instead")}),!0,null)},ServiceorderitemBulkedit.prototype.hideFields=function(entityForm,hideList){var detail=entityForm.getDetailView("Bulk Edit");detail&&hideList.forEach((function(itemName){var item=detail.getItemByName(itemName);item&&(item.isVisible=!1)}))},ServiceorderitemBulkedit.prototype.ApplyBulkEdit=function(context){var _this=this,_property=new serviceorderitem_entity_names_1.ServiceorderitemEntityNames,entityListStr=context.getDetailView("General").getItemByName(_property.bulkedit);if(entityListStr.value&&entityListStr.value.length>0){var entityList_1=JSON.parse(entityListStr.value),promises_1=[];entityList_1.forEach((function(id){promises_1.push(_this.updateEntity(id,context))})),Promise.all(promises_1).then((function(){MobileCRM.UI.Form.showToast(entityList_1.length+" records updated.","Home.Now.png"),_this.forceCloseForm()}))}},ServiceorderitemBulkedit.prototype.updateEntity=function(id,context){var _this=this;return new Promise((function(resolve,reject){MobileCRM.DynamicEntity.loadById("dw_serviceorderitem",id,(function(entity){var localMaterialEntityNames=new localmaterial_entity_names_1.LocalmaterialEntityNames,serviceOrderItemEntityNames=new serviceorderitem_entity_names_1.ServiceorderitemEntityNames;MobileCRM.DynamicEntity.loadById(localMaterialEntityNames.entityLogicalName,entity.properties[serviceOrderItemEntityNames.localmaterialId].id,(function(localMaterialRecord){context.detailViews.forEach((function(detailView){detailView.isVisible&&_this.updateFields(detailView,entity,localMaterialRecord,localMaterialEntityNames)})),entity.save((function(error){return error?reject(error):resolve()}))}))}),(function(error){if(error)return reject(error)}),null)}))},ServiceorderitemBulkedit.prototype.updateFields=function(detailView,entity,localMaterialRecord,localMaterialEntityNames){var field=new serviceorderitem_entity_names_1.ServiceorderitemEntityNames;this.changedItems.forEach((function(i){if(-1===i.indexOf("^")){var item=detailView.getItemByName(i);item&&(entity.properties[i]=item.value,item.name===field.quantity&&item.value>1&&!0===localMaterialRecord.properties[localMaterialEntityNames.traceablepart]&&(entity.properties[i]=1)),item.name===field.quantity&&entity.properties[field.quantity]&&entity.properties[field.price]&&(entity.properties[field.total]=entity.properties[field.quantity]*entity.properties[field.price])}}))},ServiceorderitemBulkedit.prototype.forceCloseForm=function(){MobileCRM.UI.EntityForm.requestObject((function(entityForm){entityForm.isDirty=!1,MobileCRM.bridge.closeForm()}),(function(error){error&&MobileCRM.bridge.alert(error)}))},ServiceorderitemBulkedit.prototype.CancelBulkEdit=function(){this.forceCloseForm()},ServiceorderitemBulkedit}();exports.ServiceorderitemBulkedit=ServiceorderitemBulkedit},8885:function(__unused_webpack_module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.ServiceorderitemEntityNames=void 0;var ServiceorderitemEntityNames=function ServiceorderitemEntityNames(){this.entityLogicalName="dw_serviceorderitem",this.accountingindicator="dw_accountingindicatorid",this.assembly="dw_assemblyid",this.assemblypart="dw_assemblypartid",this.bulkregistrationitem="dw_bulkregistrationitemid",this.chargetime="dw_chargetime",this.createdby="createdby",this.description="dw_error1description",this.dispatchId="dw_dispatchid",this.displayonprintout="dw_displayonprintout",this.endtime="dw_endtime",this.error="dw_error1id",this.errorcategory="dw_errorcategory",this.errorcause="dw_errorcausingpart",this.executiondate="dw_confirmationdate",this.localmaterialtype="dw_localmaterialtype",this.materialdescription="dw_materialdescription",this.materialno="dw_materialno",this.materialnooferrorpart="dw_materialnooferrorpart",this.modifiedby="modifiedby",this.owner="ownerid",this.price="dw_price",this.quantity="dw_quantity",this.serialnooferrorpart="dw_serialnooferrorpart",this.serialnoofnewpart="dw_serialnoofnewpart",this.serviceorderId="dw_serviceorderid",this.serviceorderitemid="dw_serviceorderitemid",this.starttime="dw_starttime",this.subassembly="dw_subassemblyid",this.localmaterialId="dw_localmaterialid",this.transactioncurrencyid="transactioncurrencyid",this.total="dw_total",this.uniquedeviceidentifier="dw_uniquedeviceidentifier",this.unit="dw_unit",this.unitId="dw_unitid",this.workcenter="dw_stockid",this.isPricelistEmpty="dw_ispricelistempty",this.bulkedit="dw_bulkedit"};exports.ServiceorderitemEntityNames=ServiceorderitemEntityNames}},__webpack_module_cache__={};return function __webpack_require__(moduleId){if(__webpack_module_cache__[moduleId])return __webpack_module_cache__[moduleId].exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module,module.exports,__webpack_require__),module.exports}(2100)}();
//# sourceMappingURL=serviceorderitem_bulkedit_form.resco.js.map