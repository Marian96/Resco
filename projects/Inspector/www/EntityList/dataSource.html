<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <title>Empty Offline HTML page</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="initial-scale=1, user-scalable=no" />
    <script src="../JSBridge.js"></script>
</head>

<body>
    <script>
           var dataSource = new MobileCRM.UI.ListDataSource();
// loadNextChunk method must be implemented explicitly
dataSource.loadNextChunk = function (page, count) {
	var fetch = this.fetch; // Take a fetch provided for current entity view
	// Specify explicit page and count requested by application (optional - it's pre-set before this method is called).
	fetch.count = count;
	fetch.page = page;
	if (page == 1) {
		// Specify custom filter or link entities.
		// Do it just for the first page!
		// WARNING: Do not add new attributes to the fetch - they will be ignored.
		var filter = new MobileCRM.FetchXml.Filter();
		filter.where("parentcustomerid", "not-null");
 
		var originalFilter = fetch.entity.filter;
		if (originalFilter && originalFilter.conditions.length > 0) {
			// Combine new filter with original filter which came from the view definition.
			var combinedFilter = new MobileCRM.FetchXml.Filter();
			combinedFilter.type = "and";
			combinedFilter.filters = [filter, originalFilter];
			fetch.entity.filter = combinedFilter;
		}
		else
			fetch.entity.filter = filter; // Set the new filter to fetch entity
	}
	// Execute fetch asynchronously and force the output type DynamicEntities.
	// When the array of DynamicEntity objects is ready, call chunkReady (don't forget to call it in scope of this ListDataSource).
	fetch.execute("DynamicEntities", function (entities) {
		// This is the final place to manipulate with the array of loaded entities before it is passed to the EntityList.
		this.chunkReady(entities); // Callback is called in scope of our dataSource, so we can call it's method chunkReady to pass the data.
	}, MobileCRM.bridge.alert, this);
};
MobileCRM.UI.EntityList.setDataSource(dataSource); 
    </script>
</body>

</html>